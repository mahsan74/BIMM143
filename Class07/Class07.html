<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mahsa Naeimi">

<title>Class 7: Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Class07_files/libs/clipboard/clipboard.min.js"></script>
<script src="Class07_files/libs/quarto-html/quarto.js"></script>
<script src="Class07_files/libs/quarto-html/popper.min.js"></script>
<script src="Class07_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Class07_files/libs/quarto-html/anchor.min.js"></script>
<link href="Class07_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Class07_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Class07_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Class07_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Class07_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 7: Machine Learning</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mahsa Naeimi </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="example-of-k-means-clustering" class="level1">
<h1>Example of k-means clustering</h1>
<p>First step is to make up some data with a known structure, so we know what the answer should be.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="at">mean=</span> <span class="sc">-</span><span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="dv">3</span>)) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">x=</span>tmp, <span class="at">y=</span> <span class="fu">rev</span>(tmp)) </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we have some structured data in <code>x</code>. Let’s see if k-mean is able to identify the two groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers=</span> <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">20</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 30, 30

Cluster means:
          x         y
1  2.778425 -3.060110
2 -3.060110  2.778425

Clustering vector:
 [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1
[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

Within cluster sum of squares by cluster:
[1] 34.37968 34.37968
 (between_SS / total_SS =  93.7 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<p>Let’s explore <code>k</code>:&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>k<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 30</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a> k<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x         y
1  2.778425 -3.060110
2 -3.060110  2.778425</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span> k<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp; Now we can add the clusters centers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span> k<span class="sc">$</span>cluster)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k<span class="sc">$</span>centers, <span class="at">col=</span> <span class="st">'blue'</span>, <span class="at">pch=</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="example-of-hierarchical-clustering" class="level1">
<h1>Example of Hierarchical Clustering</h1>
<p>Let’s use the same data as before, which we stored in ‘x’ . We will use the <code>'hclust()'</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dist</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            1          2          3          4          5          6          7
2   0.9596320                                                                  
3   0.9070136  1.2739220                                                       
4   0.6912983  0.9649569  1.5622596                                            
5   0.8104755  0.1493644  1.1792873  0.8546660                                 
6   1.0143002  1.4615749  0.1913170  1.6912679  1.3630122                      
7   0.0626604  0.9164997  0.8606275  0.7195358  0.7679730  0.9755281           
8   1.2150137  2.1742334  1.5379914  1.6147533  2.0252663  1.4740823  1.2582924
9   1.5163725  0.8315823  2.0771865  1.0788966  0.8998717  2.2583046  1.5011595
10  1.9942410  2.8093956  1.6578936  2.6119097  2.6797526  1.4815323  2.0021486
11  1.0877153  0.1749444  1.4488368  0.9852360  0.2951119  1.6363472  1.0501336
12  0.4315176  1.1491867  1.3331817  0.4229262  1.0086496  1.4266329  0.4868256
13  1.1197538  0.7837136  0.7622462  1.5269731  0.7771353  0.9413068  1.0571223
14  0.4621450  1.3633360  0.7751475  1.1048012  1.2189897  0.7938926  0.4766243
15  0.6495544  1.2382837  1.5552313  0.3429686  1.1092375  1.6515594  0.7011673
16  1.5718331  2.4135642  1.3311580  2.1836337  2.2795519  1.1736708  1.5824709
17  1.2258719  0.3467861  1.6206795  1.0356445  0.4590389  1.8081160  1.1927961
18  0.8243774  1.7369934  0.9647561  1.4114483  1.5931726  0.9075527  0.8462761
19  1.2262434  0.2836151  1.5396137  1.1158143  0.4233935  1.7292819  1.1871436
20  0.6331610  1.3177020  1.5257149  0.4625583  1.1828988  1.6092072  0.6904899
21  1.0846118  0.4200441  1.0567458  1.3066834  0.4659282  1.2472373  1.0269828
22  1.2578536  1.7007422  2.1626065  0.7434969  1.5968668  2.2534964  1.3093177
23  0.3140308  1.1202619  0.6431163  1.0051459  0.9790509  0.7210153  0.2961699
24  1.0349736  1.3186776  0.1399110  1.6771959  1.2365708  0.2296979  0.9860351
25  0.9583126  0.5679468  0.8127927  1.3086487  0.5497107  1.0030480  0.8968124
26  1.0060144  1.2696565  1.8997183  0.3534513  1.1762374  2.0190403  1.0437003
27  0.4283328  1.1432344  0.5178765  1.1179975  1.0086980  0.5945755  0.3998276
28  2.3175305  2.0250200  1.5492808  2.8110490  2.0509824  1.5965972  2.2571692
29  0.0708818  0.9835565  0.9760038  0.6372584  0.8342280  1.0797912  0.1298324
30  1.8700447  2.2266444  1.0047369  2.5503172  2.1533096  0.8590985  1.8334876
31  7.4926524  7.1593516  6.6465479  8.0008526  7.2106817  6.6267607  7.4342142
32  8.8430895  8.3509675  8.0667649  9.2644669  8.4285215  8.0807884  8.7816550
33  6.4646736  6.0110206  5.6802780  6.9058041  6.0803568  5.6939004  6.4035956
34  8.4924944  8.0359213  7.6979354  8.9352992  8.1076167  7.7042564  8.4315972
35  9.5352531  8.9825030  8.7939950  9.9169490  9.0700183  8.8213934  9.4731053
36  7.8952607  7.3713983  7.1429982  8.2950128  7.4533498  7.1678567  7.8333467
37  7.8587202  7.4238256  7.0557795  8.3133537  7.4915969  7.0588498  7.7981437
38  8.6051809  8.1420598  7.8136462  9.0441951  8.2148694  7.8212340  8.5441827
39  9.9359043  9.3981595  9.1832303 10.3282741  9.4834943  9.2059408  9.8739312
40  7.8977279  7.3483829  7.1623235  8.2802651  7.4343978  7.1936085  7.8355442
41  9.3916825  8.8857934  8.6212619  9.8047956  8.9658373  8.6372787  9.3300854
42  8.2638013  7.6693006  7.5588077  8.6142977  7.7627506  7.6004441  8.2012895
43  8.9128219  8.5020049  8.0940108  9.3825437  8.5667519  8.0882063  8.8528239
44  8.3996313  7.8006031  7.6973045  8.7468439  7.8948533  7.7396852  8.3370984
45  8.8389888  8.5067218  7.9881672  9.3498509  8.5590357  7.9642320  8.7807863
46  9.3691304  8.8523292  8.6054002  9.7750960  8.9340844  8.6241770  9.3073866
47  8.7722515  8.3276102  7.9703655  9.2224618  8.3976075  7.9730154  8.7115886
48  7.6885422  7.1764118  6.9300876  8.0957114  7.2563331  6.9527571  7.6267556
49  9.1850783  8.6807225  8.4145453  9.5989894  8.7604117  8.4306916  9.1234909
50  8.3420001  7.7583703  7.6283652  8.7006067  7.8501376  7.6669356  8.2795565
51  8.8247717  8.5373338  7.9590403  9.3570074  8.5825872  7.9249612  8.7677665
52  8.8061946  8.1775464  8.1252373  9.1307407  8.2767157  8.1741852  8.7435571
53  9.4613064  9.0640464  8.6347157  9.9391485  9.1269997  8.6244155  9.4016461
54  8.7134205  8.2225325  7.9369348  9.1354355  8.2998101  7.9510130  8.6519953
55  8.0112273  7.5944934  7.1986403  8.4764123  7.6595107  7.1968314  7.9510130
56  8.3620303  7.8064785  7.6282000  8.7407520  7.8937936  7.6595107  8.2998101
57  9.1974900  8.6550324  8.4507848  9.5860488  8.7407520  8.4764123  9.1354355
58  7.9975467  7.5598730  7.1953637  8.4507848  7.6282000  7.1986403  7.9369348
59  8.2848597  7.7173030  7.5598730  8.6550324  7.8064785  7.5944934  8.2225325
60  8.7748280  8.2848597  7.9975467  9.1974900  8.3620303  8.0112273  8.7134205
            8          9         10         11         12         13         14
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9   2.6545069                                                                  
10  1.2434033  3.5003561                                                       
11  2.3010063  0.6675392  2.9742443                                            
12  1.1966791  1.4672641  2.2026152  1.2264196                                 
13  2.1519922  1.6020035  2.4199532  0.9355212  1.5043130                      
14  0.8649717  1.9768296  1.5330631  1.5098282  0.7336984  1.2923634           
15  1.3108337  1.4209983  2.3839956  1.2872207  0.2253135  1.6809606  0.9503346
16  0.8828250  3.0831614  0.4283083  2.5746582  1.7745997  2.0872077  1.1097794
17  2.4324812  0.5143627  3.1377787  0.1718463  1.3220039  1.0907057  1.6599344
18  0.5732353  2.3399033  1.2005318  1.8842847  1.0038344  1.6026530  0.3744649
19  2.4404949  0.6485520  3.0925077  0.1421238  1.3676861  0.9693026  1.6423403
20  1.1871749  1.5414141  2.2764108  1.3783841  0.2067457  1.7095135  0.8769698
21  2.2456552  1.2107932  2.6904478  0.5504427  1.3906305  0.3988185  1.3864293
22  1.6383008  1.5977129  2.8300426  1.6997894  0.8295299  2.2533231  1.5182536
23  1.1177737  1.7763074  1.7247489  1.2728138  0.7060924  1.0520819  0.2556178
24  1.6643033  2.1363597  1.7059388  1.4930943  1.4638000  0.7279315  0.9145987
25  2.0644177  1.3961231  2.4525820  0.7289511  1.3162233  0.2289338  1.1995987
26  1.7288325  1.1754047  2.8239623  1.2580202  0.6389651  1.8765622  1.3715755
27  1.1678314  1.8396294  1.6733128  1.3037827  0.8320666  0.9847873  0.3095953
28  3.0703706  2.7730176  2.8109926  2.1443524  2.7373215  1.2894930  2.3172933
29  1.1980209  1.5033282  2.0204621  1.1035076  0.3607374  1.1823516  0.4881834
30  2.0283066  3.0517598  1.4157382  2.3992467  2.2720635  1.5368002  1.5848481
31  8.0191307  7.7949319  7.2476893  7.2474149  7.9192948  6.4745775  7.4146871
32  9.5312469  8.8701798  8.8955766  8.4075881  9.2530478  7.7561412  8.8414206
33  7.1464316  6.5790491  6.5465511  6.0790844  6.8783073  5.3880782  6.4551139
34  9.1443866  8.5842960  8.4761132  8.1000951  8.9073757  7.4181093  8.4730783
35 10.2855220  9.4471971  9.7090809  9.0254707  9.9349587  8.4311075  9.5649372
36  8.6305597  7.8722113  8.0598279  7.4225984  8.2992644  6.7973549  7.9151370
37  8.4948048  7.9921621  7.8202774  7.4930466  8.2759679  6.7922089  7.8307618
38  9.2631206  8.6848739  8.5994112  8.2048047  9.0192420  7.5284114  8.5887901
39 10.6656065  9.8735760 10.0618438  9.4440421 10.3387003  8.8359094  9.9558328
40  8.6612492  7.8278024  8.1224341  7.3940498  8.2969701  6.7930899  7.9318487
41 10.0898093  9.3907161  9.4579119  8.9389758  9.7997572  8.3007130  9.3955723
42  9.0730832  8.1050126  8.5827252  7.7041905  8.6537131  7.1502747  8.3222324
43  9.5069673  9.0799799  8.7767422  8.5744410  9.3334132  7.8582298  8.8675991
44  9.2125363  8.2309223  8.7245873  7.8342534  8.7885939  7.2854671  8.4601623
45  9.3427323  9.1348482  8.5320831  8.5932385  9.2662333  7.8236129  8.7541071
46 10.0799472  9.3485178  9.4618831  8.9032419  9.7753627  8.2747381  9.3791368
47  9.4070365  8.8828273  8.7178843  8.3937781  9.1888434  7.7029585  8.7453359
48  8.4136053  7.6884829  7.8350501  7.2304048  8.0944172  6.5938424  7.7029585
49  9.8835177  9.1881095  9.2544044  8.7344382  9.5932884  8.0944172  9.1888434
50  9.1384219  8.2035702  8.6313182  7.7956902  8.7344382  7.2304048  8.3937781
51  9.2759803  9.1910006  8.4217718  8.6313182  9.2544044  7.8350501  8.7178843
52  9.6482053  8.5756300  9.1910006  8.2035702  9.1881095  7.6884829  8.8828273
53 10.0332520  9.6482053  9.2759803  9.1384219  9.8835177  8.4136053  9.4070365
54  9.4016461  8.7435571  8.7677665  8.2795565  9.1234909  7.6267556  8.7115886
55  8.6244155  8.1741852  7.9249612  7.6669356  8.4306916  6.9527571  7.9730154
56  9.1269997  8.2767157  8.5825872  7.8501376  8.7604117  7.2563331  8.3976075
57  9.9391485  9.1307407  9.3570074  8.7006067  9.5989894  8.0957114  9.2224618
58  8.6347157  8.1252373  7.9590403  7.6283652  8.4145453  6.9300876  7.9703655
59  9.0640464  8.1775464  8.5373338  7.7583703  8.6807225  7.1764118  8.3276102
60  9.4613064  8.8061946  8.8247717  8.3420001  9.1850783  7.6885422  8.7722515
           15         16         17         18         19         20         21
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16  1.9578713                                                                  
17  1.3572866  2.7351810                                                       
18  1.1942706  0.7722271  2.0340848                                            
19  1.4240282  2.6971793  0.1421898  2.0165598                                 
20  0.1257337  1.8518585  1.4576423  1.0948167  1.5172874                      
21  1.5276409  2.3256653  0.6969584  1.7396896  0.5715199  1.5834186           
22  0.6083488  2.4174917  1.7180610  1.6951996  1.8194300  0.6463326  2.0500173
23  0.9312889  1.3119185  1.4283940  0.6203604  1.4018356  0.8891597  1.1308882
24  1.6843968  1.4033665  1.6644055  1.0916873  1.5738178  1.6586103  1.0608067
25  1.4809316  2.0943178  0.8917210  1.5383559  0.7810877  1.5185287  0.2444117
26  0.4399820  2.3978320  1.2719244  1.6330584  1.3749744  0.5516638  1.6380201
27  1.0570606  1.2709253  1.4652827  0.6343700  1.4267854  1.0163147  1.1063975
28  2.9340811  2.6439530  2.2674055  2.5010217  2.1275479  2.9437677  1.6049937
29  0.5796416  1.5957120  1.2352786  0.8380303  1.2436736  0.5623381  1.1318535
30  2.4973286  1.3490372  2.5688314  1.5504580  2.4681751  2.4448123  1.9211913
31  8.1217748  7.3175238  7.3354382  7.5000538  7.1939945  8.1244894  6.7477010
32  9.4368121  8.9095517  8.4646890  8.9825434  8.3290004  9.4596350  7.9643374
33  7.0661757  6.5404470  6.1484420  6.5961532  6.0097937  7.0850443  5.6145769
34  9.0959739  8.5030449  8.1646531  8.6015639  8.0271215  9.1141212  7.6420711
35 10.1094535  9.7001677  9.0690514  9.7279177  8.9373632 10.1405324  8.6106215
36  8.4778771  8.0457236  7.4748516  8.0739162  7.3404514  8.5053763  6.9909808
37  8.4671095  7.8486403  7.5627509  7.9541333  7.4240938  8.4826760  7.0256958
38  9.2070012  8.6246252  8.2679347  8.7193384  8.1307368  9.2259810  7.7495037
39 10.5157785 10.0644443  9.4903303 10.1111628  9.3577946 10.5446461  9.0227199
40  8.4715050  8.0957383  7.4409370  8.1008665  7.3081296  8.5025241  6.9742362
41  9.9816672  9.4711945  8.9925421  9.5399042  8.8578324 10.0062141  8.5025241
42  8.8205251  8.5380763  7.7404271  8.5076958  7.6111737  8.8578324  7.3081296
43  9.5280191  8.8308508  8.6468475  8.9755374  8.5076958  9.5399042  8.1008665
44  8.9546094  8.6792896  7.8692192  8.6468475  7.7404271  8.9925421  7.4409370
45  9.4694780  8.6220566  8.6792896  8.8308508  8.5380763  9.4711945  8.0957383
46  9.9556007  9.4694780  8.9546094  9.5280191  8.8205251  9.9816672  8.4715050
47  9.3791368  8.7541071  8.4601623  8.8675991  8.3222324  9.3955723  7.9318487
48  8.2747381  7.8236129  7.2854671  7.8582298  7.1502747  8.3007130  6.7930899
49  9.7753627  9.2662333  8.7885939  9.3334132  8.6537131  9.7997572  8.2969701
50  8.9032419  8.5932385  7.8342534  8.5744410  7.7041905  8.9389758  7.3940498
51  9.4618831  8.5320831  8.7245873  8.7767422  8.5827252  9.4579119  8.1224341
52  9.3485178  9.1348482  8.2309223  9.0799799  8.1050126  9.3907161  7.8278024
53 10.0799472  9.3427323  9.2125363  9.5069673  9.0730832 10.0898093  8.6612492
54  9.3073866  8.7807863  8.3370984  8.8528239  8.2012895  9.3300854  7.8355442
55  8.6241770  7.9642320  7.7396852  8.0882063  7.6004441  8.6372787  7.1936085
56  8.9340844  8.5590357  7.8948533  8.5667519  7.7627506  8.9658373  7.4343978
57  9.7750960  9.3498509  8.7468439  9.3825437  8.6142977  9.8047956  8.2802651
58  8.6054002  7.9881672  7.6973045  8.0940108  7.5588077  8.6212619  7.1623235
59  8.8523292  8.5067218  7.8006031  8.5020049  7.6693006  8.8857934  7.3483829
60  9.3691304  8.8389888  8.3996313  8.9128219  8.2638013  9.3916825  7.8977279
           22         23         24         25         26         27         28
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23  1.5325517                                                                  
24  2.2924946  0.7801727                                                       
25  2.0413619  0.9473549  0.8173714                                            
26  0.4462870  1.3134843  2.0188632  1.6558058                                 
27  1.6593555  0.1272046  0.6559140  0.9047752  1.4333362                      
28  3.5247315  2.1409567  1.4143097  1.5160125  3.1626990  2.0300324           
29  1.1877895  0.3706317  1.1047599  1.0152473  0.9435964  0.4898773  2.3869666
30  3.0911342  1.5677368  0.9202336  1.6898751  2.8759757  1.4443762  1.4328940
31  8.7160260  7.2812979  6.5068458  6.6967110  8.3511340  7.1603389  5.1917271
32 10.0030862  8.6739897  7.9279719  7.9625854  9.6019677  8.5614189  6.5333874
33  7.6401866  6.2899472  5.5413700  5.5990516  7.2478276  6.1765109  4.1506292
34  9.6701357  8.3131389  7.5585326  7.6289198  9.2766680  8.1983365  6.1765109
35 10.6596500  9.3848917  8.6568279  8.6288570 10.2462393  9.2766680  7.2478276
36  9.0360622  7.7384602  7.0054152  6.9992002  8.6288570  7.6289198  5.5990516
37  9.0454277  7.6743285  6.9161826  7.0054152  8.6568279  7.5585326  5.5413700
38  9.7798016  8.4275751  7.6743285  7.7384602  9.3848917  8.3131389  6.2899472
39 11.0703023  9.7798016  9.0454277  9.0360622 10.6596500  9.6701357  7.6401866
40  9.0227199  7.7495037  7.0256958  6.9909808  8.6106215  7.6420711  5.6145769
41 10.5446461  9.2259810  8.4826760  8.5053763 10.1405324  9.1141212  7.0850443
42  9.3577946  8.1307368  7.4240938  7.3404514  8.9373632  8.0271215  6.0097937
43 10.1111628  8.7193384  7.9541333  8.0739162  9.7279177  8.6015639  6.5961532
44  9.4903303  8.2679347  7.5627509  7.4748516  9.0690514  8.1646531  6.1484420
45 10.0644443  8.6246252  7.8486403  8.0457236  9.7001677  8.5030449  6.5404470
46 10.5157785  9.2070012  8.4671095  8.4778771 10.1094535  9.0959739  7.0661757
47  9.9558328  8.5887901  7.8307618  7.9151370  9.5649372  8.4730783  6.4551139
48  8.8359094  7.5284114  6.7922089  6.7973549  8.4311075  7.4181093  5.3880782
49 10.3387003  9.0192420  8.2759679  8.2992644  9.9349587  8.9073757  6.8783073
50  9.4440421  8.2048047  7.4930466  7.4225984  9.0254707  8.1000951  6.0790844
51 10.0618438  8.5994112  7.8202774  8.0598279  9.7090809  8.4761132  6.5465511
52  9.8735760  8.6848739  7.9921621  7.8722113  9.4471971  8.5842960  6.5790491
53 10.6656065  9.2631206  8.4948048  8.6305597 10.2855220  9.1443866  7.1464316
54  9.8739312  8.5441827  7.7981437  7.8333467  9.4731053  8.4315972  6.4035956
55  9.2059408  7.8212340  7.0588498  7.1678567  8.8213934  7.7042564  5.6939004
56  9.4834943  8.2148694  7.4915969  7.4533498  9.0700183  8.1076167  6.0803568
57 10.3282741  9.0441951  8.3133537  8.2950128  9.9169490  8.9352992  6.9058041
58  9.1832303  7.8136462  7.0557795  7.1429982  8.7939950  7.6979354  5.6802780
59  9.3981595  8.1420598  7.4238256  7.3713983  8.9825030  8.0359213  6.0110206
60  9.9359043  8.6051809  7.8587202  7.8952607  9.5352531  8.4924944  6.4646736
           29         30         31         32         33         34         35
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30  1.9337916                                                                  
31  7.5631419  5.9992940                                                       
32  8.9113095  7.5631419  1.9337916                                            
33  6.5333874  5.1917271  1.4328940  2.3869666                                 
34  8.5614189  7.1603389  1.4443762  0.4898773  2.0300324                      
35  9.6019677  8.3511340  2.8759757  0.9435964  3.1626990  1.4333362           
36  7.9625854  6.6967110  1.6898751  1.0152473  1.5160125  0.9047752  1.6558058
37  7.9279719  6.5068458  0.9202336  1.1047599  1.4143097  0.6559140  2.0188632
38  8.6739897  7.2812979  1.5677368  0.3706317  2.1409567  0.1272046  1.3134843
39 10.0030862  8.7160260  3.0911342  1.1877895  3.5247315  1.6593555  0.4462870
40  7.9643374  6.7477010  1.9211913  1.1318535  1.6049937  1.1063975  1.6380201
41  9.4596350  8.1244894  2.4448123  0.5623381  2.9437677  1.0163147  0.5516638
42  8.3290004  7.1939945  2.4681751  1.2436736  2.1275479  1.4267854  1.3749744
43  8.9825434  7.5000538  1.5504580  0.8380303  2.5010217  0.6343700  1.6330584
44  8.4646890  7.3354382  2.5688314  1.2352786  2.2674055  1.4652827  1.2719244
45  8.9095517  7.3175238  1.3490372  1.5957120  2.6439530  1.2709253  2.3978320
46  9.4368121  8.1217748  2.4973286  0.5796416  2.9340811  1.0570606  0.4399820
47  8.8414206  7.4146871  1.5848481  0.4881834  2.3172933  0.3095953  1.3715755
48  7.7561412  6.4745775  1.5368002  1.1823516  1.2894930  0.9847873  1.8765622
49  9.2530478  7.9192948  2.2720635  0.3607374  2.7373215  0.8320666  0.6389651
50  8.4075881  7.2474149  2.3992467  1.1035076  2.1443524  1.3037827  1.2580202
51  8.8955766  7.2476893  1.4157382  2.0204621  2.8109926  1.6733128  2.8239623
52  8.8701798  7.7949319  3.0517598  1.5033282  2.7730176  1.8396294  1.1754047
53  9.5312469  8.0191307  2.0283066  1.1980209  3.0703706  1.1678314  1.7288325
54  8.7816550  7.4342142  1.8334876  0.1298324  2.2571692  0.3998276  1.0437003
55  8.0807884  6.6267607  0.8590985  1.0797912  1.5965972  0.5945755  2.0190403
56  8.4285215  7.2106817  2.1533096  0.8342280  2.0509824  1.0086980  1.1762374
57  9.2644669  8.0008526  2.5503172  0.6372584  2.8110490  1.1179975  0.3534513
58  8.0667649  6.6465479  1.0047369  0.9760038  1.5492808  0.5178765  1.8997183
59  8.3509675  7.1593516  2.2266444  0.9835565  2.0250200  1.1432344  1.2696565
60  8.8430895  7.4926524  1.8700447  0.0708818  2.3175305  0.4283328  1.0060144
           36         37         38         39         40         41         42
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30                                                                             
31                                                                             
32                                                                             
33                                                                             
34                                                                             
35                                                                             
36                                                                             
37  0.8173714                                                                  
38  0.9473549  0.7801727                                                       
39  2.0413619  2.2924946  1.5325517                                            
40  0.2444117  1.0608067  1.1308882  2.0500173                                 
41  1.5185287  1.6586103  0.8891597  0.6463326  1.5834186                      
42  0.7810877  1.5738178  1.4018356  1.8194300  0.5715199  1.5172874           
43  1.5383559  1.0916873  0.6203604  1.6951996  1.7396896  1.0948167  2.0165598
44  0.8917210  1.6644055  1.4283940  1.7180610  0.6969584  1.4576423  0.1421898
45  2.0943178  1.4033665  1.3119185  2.4174917  2.3256653  1.8518585  2.6971793
46  1.4809316  1.6843968  0.9312889  0.6083488  1.5276409  0.1257337  1.4240282
47  1.1995987  0.9145987  0.2556178  1.5182536  1.3864293  0.8769698  1.6423403
48  0.2289338  0.7279315  1.0520819  2.2533231  0.3988185  1.7095135  0.9693026
49  1.3162233  1.4638000  0.7060924  0.8295299  1.3906305  0.2067457  1.3676861
50  0.7289511  1.4930943  1.2728138  1.6997894  0.5504427  1.3783841  0.1421238
51  2.4525820  1.7059388  1.7247489  2.8300426  2.6904478  2.2764108  3.0925077
52  1.3961231  2.1363597  1.7763074  1.5977129  1.2107932  1.5414141  0.6485520
53  2.0644177  1.6643033  1.1177737  1.6383008  2.2456552  1.1871749  2.4404949
54  0.8968124  0.9860351  0.2961699  1.3093177  1.0269828  0.6904899  1.1871436
55  1.0030480  0.2296979  0.7210153  2.2534964  1.2472373  1.6092072  1.7292819
56  0.5497107  1.2365708  0.9790509  1.5968668  0.4659282  1.1828988  0.4233935
57  1.3086487  1.6771959  1.0051459  0.7434969  1.3066834  0.4625583  1.1158143
58  0.8127927  0.1399110  0.6431163  2.1626065  1.0567458  1.5257149  1.5396137
59  0.5679468  1.3186776  1.1202619  1.7007422  0.4200441  1.3177020  0.2836151
60  0.9583126  1.0349736  0.3140308  1.2578536  1.0846118  0.6331610  1.2262434
           43         44         45         46         47         48         49
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30                                                                             
31                                                                             
32                                                                             
33                                                                             
34                                                                             
35                                                                             
36                                                                             
37                                                                             
38                                                                             
39                                                                             
40                                                                             
41                                                                             
42                                                                             
43                                                                             
44  2.0340848                                                                  
45  0.7722271  2.7351810                                                       
46  1.1942706  1.3572866  1.9578713                                            
47  0.3744649  1.6599344  1.1097794  0.9503346                                 
48  1.6026530  1.0907057  2.0872077  1.6809606  1.2923634                      
49  1.0038344  1.3220039  1.7745997  0.2253135  0.7336984  1.5043130           
50  1.8842847  0.1718463  2.5746582  1.2872207  1.5098282  0.9355212  1.2264196
51  1.2005318  3.1377787  0.4283083  2.3839956  1.5330631  2.4199532  2.2026152
52  2.3399033  0.5143627  3.0831614  1.4209983  1.9768296  1.6020035  1.4672641
53  0.5732353  2.4324812  0.8828250  1.3108337  0.8649717  2.1519922  1.1966791
54  0.8462761  1.1927961  1.5824709  0.7011673  0.4766243  1.0571223  0.4868256
55  0.9075527  1.8081160  1.1736708  1.6515594  0.7938926  0.9413068  1.4266329
56  1.5931726  0.4590389  2.2795519  1.1092375  1.2189897  0.7771353  1.0086496
57  1.4114483  1.0356445  2.1836337  0.3429686  1.1048012  1.5269731  0.4229262
58  0.9647561  1.6206795  1.3311580  1.5552313  0.7751475  0.7622462  1.3331817
59  1.7369934  0.3467861  2.4135642  1.2382837  1.3633360  0.7837136  1.1491867
60  0.8243774  1.2258719  1.5718331  0.6495544  0.4621450  1.1197538  0.4315176
           50         51         52         53         54         55         56
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30                                                                             
31                                                                             
32                                                                             
33                                                                             
34                                                                             
35                                                                             
36                                                                             
37                                                                             
38                                                                             
39                                                                             
40                                                                             
41                                                                             
42                                                                             
43                                                                             
44                                                                             
45                                                                             
46                                                                             
47                                                                             
48                                                                             
49                                                                             
50                                                                             
51  2.9742443                                                                  
52  0.6675392  3.5003561                                                       
53  2.3010063  1.2434033  2.6545069                                            
54  1.0501336  2.0021486  1.5011595  1.2582924                                 
55  1.6363472  1.4815323  2.2583046  1.4740823  0.9755281                      
56  0.2951119  2.6797526  0.8998717  2.0252663  0.7679730  1.3630122           
57  0.9852360  2.6119097  1.0788966  1.6147533  0.7195358  1.6912679  0.8546660
58  1.4488368  1.6578936  2.0771865  1.5379914  0.8606275  0.1913170  1.1792873
59  0.1749444  2.8093956  0.8315823  2.1742334  0.9164997  1.4615749  0.1493644
60  1.0877153  1.9942410  1.5163725  1.2150137  0.0626604  1.0143002  0.8104755
           57         58         59
2                                  
3                                  
4                                  
5                                  
6                                  
7                                  
8                                  
9                                  
10                                 
11                                 
12                                 
13                                 
14                                 
15                                 
16                                 
17                                 
18                                 
19                                 
20                                 
21                                 
22                                 
23                                 
24                                 
25                                 
26                                 
27                                 
28                                 
29                                 
30                                 
31                                 
32                                 
33                                 
34                                 
35                                 
36                                 
37                                 
38                                 
39                                 
40                                 
41                                 
42                                 
43                                 
44                                 
45                                 
46                                 
47                                 
48                                 
49                                 
50                                 
51                                 
52                                 
53                                 
54                                 
55                                 
56                                 
57                                 
58  1.5622596                      
59  0.9649569  1.2739220           
60  0.6912983  0.9070136  0.9596320</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>clustering <span class="ot">&lt;-</span> <span class="fu">hclust</span>( <span class="fu">dist</span>(x))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>clustering </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hclust(d = dist(x))

Cluster method   : complete 
Distance         : euclidean 
Number of objects: 60 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clustering)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>group in the left from 1-30 and group to the right from 30-60</p>
<p>Let’s add horizontal line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clustering)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">'pink'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>to get our results (i.e., membership vector) we need to “cut” the tree. The function for doing that is cutree()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>subgroups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(clustering, <span class="at">h =</span><span class="dv">10</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>subgroups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<p>plotting this..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(x, <span class="at">col =</span> subgroups)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can also “cut” your tree with the number of clusters you want:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">cutree</span>(clustering, <span class="at">h =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 3 2 2 3 1 4 2 4 2 2 1 1 2 4 2 4 2 2 1 2 1 3 1 2 1 3 1 3 5 6 5 6 7 6 5 6
[39] 7 6 7 7 8 7 8 7 6 6 7 7 8 7 8 6 5 7 7 5 7 6</code></pre>
</div>
</div>
</section>
<section id="principle-component-analysis-pca" class="level1">
<h1>Principle Component Analysis (PCA)</h1>
<section id="pca-of-uk-food" class="level2">
<h2 class="anchored" data-anchor-id="pca-of-uk-food">PCA of UK food</h2>
<p>First we read the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a> url <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/UK-foods"</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> <span class="fu">read.csv</span> (url, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">head</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               England Wales Scotland N.Ireland
Cheese             105   103      103        66
Carcass_meat       245   227      242       267
Other_meat         685   803      750       586
Fish               147   160      122        93
Fats_and_oils      193   235      184       209
Sugars             156   175      147       139</code></pre>
</div>
</div>
<p>Now we can generate some basic visualization</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rainbow</span> (<span class="fu">nrow</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "#FF0000" "#FF5A00" "#FFB400" "#F0FF00" "#96FF00" "#3CFF00" "#00FF1E"
 [8] "#00FF78" "#00FFD2" "#00D2FF" "#0078FF" "#001EFF" "#3C00FF" "#9600FF"
[15] "#F000FF" "#FF00B4" "#FF005A"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>( <span class="fu">as.matrix</span>(x), <span class="at">col=</span><span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s refine our barplot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>( <span class="fu">as.matrix</span>(x), <span class="at">col=</span><span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)), <span class="at">beside =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Other useful visualization:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x, <span class="at">col =</span>  <span class="fu">rainbow</span>(<span class="fu">nrow</span>(x) ), <span class="at">pch =</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s apply PCA. For that we need to use the command prcpm(). This function expects the transpose of our data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>transpose_matrix <span class="ot">&lt;-</span> <span class="fu">t</span>(x)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>( transpose_matrix)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span> ( <span class="fu">t</span>(x))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                            PC1      PC2      PC3       PC4
Standard deviation     324.1502 212.7478 73.87622 4.189e-14
Proportion of Variance   0.6744   0.2905  0.03503 0.000e+00
Cumulative Proportion    0.6744   0.9650  1.00000 1.000e+00</code></pre>
</div>
</div>
<p>Let’s plot the PCA results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We need to access the results of PCA analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">attributes</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "sdev"     "rotation" "center"   "scale"    "x"       

$class
[1] "prcomp"</code></pre>
</div>
</div>
<p>We can explore the pca$x dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a> pca<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 PC1         PC2         PC3           PC4
England   -144.99315    2.532999 -105.768945  2.842865e-14
Wales     -240.52915  224.646925   56.475555  7.804382e-13
Scotland   -91.86934 -286.081786   44.415495 -9.614462e-13
N.Ireland  477.39164   58.901862    4.877895  1.448078e-13</code></pre>
</div>
</div>
<p>Plotting:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="at">x=</span>pca<span class="sc">$</span>x[,<span class="dv">1</span>], <span class="at">y=</span>pca<span class="sc">$</span>x[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="at">x=</span>pca<span class="sc">$</span>x[,<span class="dv">1</span>], <span class="at">y=</span>pca<span class="sc">$</span>x[,<span class="dv">2</span>])</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>color_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'orange'</span>, <span class="st">'pink'</span>, <span class="st">'blue'</span>, <span class="st">'green'</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>( <span class="at">x=</span>pca<span class="sc">$</span>x[,<span class="dv">1</span>], <span class="at">y=</span>pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="fu">colnames</span>(x), <span class="at">col =</span> color_countries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="pca-of-a-rna-seq-data-set" class="level2">
<h2 class="anchored" data-anchor-id="pca-of-a-rna-seq-data-set">PCA of a RNA-seq data set</h2>
<p>First step as always to load the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>url2 <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/expression-CSV"</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>rna.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url2, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rna.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       wt1 wt2  wt3  wt4 wt5 ko1 ko2 ko3 ko4 ko5
gene1  439 458  408  429 420  90  88  86  90  93
gene2  219 200  204  210 187 427 423 434 433 426
gene3 1006 989 1030 1017 973 252 237 238 226 210
gene4  783 792  829  856 760 849 856 835 885 894
gene5  181 249  204  244 225 277 305 272 270 279
gene6  460 502  491  491 493 612 594 577 618 638</code></pre>
</div>
</div>
<p>Q. How many genes and samples are in this data set?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(rna.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100  10</code></pre>
</div>
</div>
<p>100 genes and 10 samples</p>
<p>Let’s apply PCA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a> pca_rna <span class="ot">=</span> <span class="fu">prcomp</span> (<span class="fu">t</span>(rna.data))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(pca_rna)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                             PC1     PC2      PC3      PC4      PC5      PC6
Standard deviation     2214.2633 88.9209 84.33908 77.74094 69.66341 67.78516
Proportion of Variance    0.9917  0.0016  0.00144  0.00122  0.00098  0.00093
Cumulative Proportion     0.9917  0.9933  0.99471  0.99593  0.99691  0.99784
                            PC7      PC8      PC9      PC10
Standard deviation     65.29428 59.90981 53.20803 3.142e-13
Proportion of Variance  0.00086  0.00073  0.00057 0.000e+00
Cumulative Proportion   0.99870  0.99943  1.00000 1.000e+00</code></pre>
</div>
</div>
<p>LEt’s plot the principle component 1 and 2 :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_rna<span class="sc">$</span>x[,<span class="dv">1</span>], pca_rna<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab =</span><span class="st">'PC1'</span>, <span class="at">ylab=</span><span class="st">'PC2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">colnames</span>(rna.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "wt1" "wt2" "wt3" "wt4" "wt5" "ko1" "ko2" "ko3" "ko4" "ko5"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a> cols_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">'blue'</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">'red'</span>,<span class="dv">5</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a> cols_samples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "blue" "blue" "blue" "blue" "blue" "red"  "red"  "red"  "red"  "red" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(pca_rna<span class="sc">$</span>x[,<span class="dv">1</span>], pca_rna<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab =</span><span class="st">'PC1'</span>, <span class="at">ylab=</span><span class="st">'PC2'</span>, <span class="at">col =</span> cols_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">barplot</span>(pca_rna<span class="sc">$</span>rotation[,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(pca_rna<span class="sc">$</span>rotation[,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      gene50       gene18        gene3       gene57       gene75       gene79 
-0.188796985 -0.185668500 -0.183374164 -0.160771014 -0.153164404 -0.146803635 
      gene56       gene61       gene27       gene17       gene44       gene13 
-0.132330117 -0.124572881 -0.123615228 -0.122536548 -0.117808971 -0.113357525 
      gene59       gene54       gene53       gene25        gene1       gene39 
-0.103935563 -0.102503320 -0.093979884 -0.083761992 -0.081247810 -0.077306742 
      gene82       gene29       gene58       gene51       gene49       gene86 
-0.076658760 -0.075605635 -0.075274651 -0.069855142 -0.069530208 -0.069165267 
      gene91       gene32       gene19       gene94       gene87       gene11 
-0.065288752 -0.064721235 -0.062411218 -0.061938300 -0.059547317 -0.055698801 
      gene81       gene40       gene31       gene46       gene70       gene77 
-0.043780416 -0.037323670 -0.037219970 -0.031990529 -0.030784982 -0.029225446 
      gene78       gene24       gene12       gene26       gene96       gene80 
-0.025639741 -0.025407507 -0.024870802 -0.022868107 -0.022293151 -0.021824860 
      gene43       gene42       gene65       gene64        gene9       gene84 
-0.020617052 -0.014550791 -0.014052839 -0.012639567 -0.007495075 -0.001289937 
      gene83       gene69        gene4        gene5       gene97       gene37 
 0.008504287  0.008871890  0.014242602  0.014303808  0.014994546  0.021280555 
      gene88        gene8       gene89        gene6       gene92       gene35 
 0.024015925  0.024026657  0.027652967  0.028634131  0.029394259  0.031349942 
      gene95       gene71       gene52       gene67       gene74       gene73 
 0.035342407  0.035589259  0.035802086  0.037840851  0.044286948  0.044581700 
      gene93       gene15       gene36       gene14       gene22        gene2 
 0.044940861  0.049090676  0.051765605  0.052004194  0.053013523  0.053465569 
      gene63        gene7       gene38       gene47       gene33       gene20 
 0.060529157  0.063389255  0.066665407  0.067141911  0.068437703  0.071571203 
      gene72       gene16       gene30       gene76       gene55       gene34 
 0.078551648  0.081254592  0.089150461  0.104435777  0.114988217  0.119604059 
      gene85       gene68       gene28       gene99      gene100       gene41 
 0.134907896  0.144227333  0.150812015  0.151678253  0.152877246  0.153077075 
      gene23       gene66       gene90       gene60       gene62       gene48 
 0.165155192  0.171311307  0.173156806  0.183139926  0.184203008  0.190495289 
      gene21       gene10       gene45       gene98 
 0.194884023  0.197905454  0.225149201  0.230633225 </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>